import{O as ot,D as ht,A as pt,a as Ue,j as I,P as gt,u as wt,b as yt,c as Et,d as vt,e as xt,f as Mt,M as Be,m as Ct,g as le,h as Me,i as ue,k as Rt,l as bt,n as At,o as _t,p as Nt,I as kt,q as It,r as $e,s as Pt,S as ze,t as Ot,R as St,v as Lt,w as Tt,x as Ze,y as Dt,z as jt,B as Ft,C as qt,E as Wt,W as Ut,F as Bt,G as $t}from"./index-cycpxOLf.js";import{R as zt,b as A,e as Zt}from"./react-vendor-CH-h0uFD.js";var Gt=Object.getOwnPropertyNames,Vt=Object.getOwnPropertySymbols,Ht=Object.prototype.hasOwnProperty;function Ge(n,e){return function(r,s,o){return n(r,s,o)&&e(r,s,o)}}function fe(n){return function(t,r,s){if(!t||!r||typeof t!="object"||typeof r!="object")return n(t,r,s);var o=s.cache,a=o.get(t),c=o.get(r);if(a&&c)return a===r&&c===t;o.set(t,r),o.set(r,t);var i=n(t,r,s);return o.delete(t),o.delete(r),i}}function Kt(n){return n!=null?n[Symbol.toStringTag]:void 0}function Ve(n){return Gt(n).concat(Vt(n))}var Xt=Object.hasOwn||function(n,e){return Ht.call(n,e)};function J(n,e){return n===e||!n&&!e&&n!==n&&e!==e}var Yt="__v",Jt="__o",Qt="_owner",He=Object.getOwnPropertyDescriptor,Ke=Object.keys;function er(n,e,t){var r=n.length;if(e.length!==r)return!1;for(;r-- >0;)if(!t.equals(n[r],e[r],r,r,n,e,t))return!1;return!0}function tr(n,e){return J(n.getTime(),e.getTime())}function rr(n,e){return n.name===e.name&&n.message===e.message&&n.cause===e.cause&&n.stack===e.stack}function nr(n,e){return n===e}function Xe(n,e,t){var r=n.size;if(r!==e.size)return!1;if(!r)return!0;for(var s=new Array(r),o=n.entries(),a,c,i=0;(a=o.next())&&!a.done;){for(var u=e.entries(),f=!1,l=0;(c=u.next())&&!c.done;){if(s[l]){l++;continue}var m=a.value,p=c.value;if(t.equals(m[0],p[0],i,l,n,e,t)&&t.equals(m[1],p[1],m[0],p[0],n,e,t)){f=s[l]=!0;break}l++}if(!f)return!1;i++}return!0}var sr=J;function or(n,e,t){var r=Ke(n),s=r.length;if(Ke(e).length!==s)return!1;for(;s-- >0;)if(!it(n,e,t,r[s]))return!1;return!0}function re(n,e,t){var r=Ve(n),s=r.length;if(Ve(e).length!==s)return!1;for(var o,a,c;s-- >0;)if(o=r[s],!it(n,e,t,o)||(a=He(n,o),c=He(e,o),(a||c)&&(!a||!c||a.configurable!==c.configurable||a.enumerable!==c.enumerable||a.writable!==c.writable)))return!1;return!0}function ir(n,e){return J(n.valueOf(),e.valueOf())}function ar(n,e){return n.source===e.source&&n.flags===e.flags}function Ye(n,e,t){var r=n.size;if(r!==e.size)return!1;if(!r)return!0;for(var s=new Array(r),o=n.values(),a,c;(a=o.next())&&!a.done;){for(var i=e.values(),u=!1,f=0;(c=i.next())&&!c.done;){if(!s[f]&&t.equals(a.value,c.value,a.value,c.value,n,e,t)){u=s[f]=!0;break}f++}if(!u)return!1}return!0}function cr(n,e){var t=n.length;if(e.length!==t)return!1;for(;t-- >0;)if(n[t]!==e[t])return!1;return!0}function lr(n,e){return n.hostname===e.hostname&&n.pathname===e.pathname&&n.protocol===e.protocol&&n.port===e.port&&n.hash===e.hash&&n.username===e.username&&n.password===e.password}function it(n,e,t,r){return(r===Qt||r===Jt||r===Yt)&&(n.$$typeof||e.$$typeof)?!0:Xt(e,r)&&t.equals(n[r],e[r],r,r,n,e,t)}var ur="[object Arguments]",fr="[object Boolean]",dr="[object Date]",mr="[object Error]",hr="[object Map]",pr="[object Number]",gr="[object Object]",wr="[object RegExp]",yr="[object Set]",Er="[object String]",vr="[object URL]",xr=Array.isArray,Je=typeof ArrayBuffer<"u"&&typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView:null,Qe=Object.assign,Mr=Object.prototype.toString.call.bind(Object.prototype.toString);function Cr(n){var e=n.areArraysEqual,t=n.areDatesEqual,r=n.areErrorsEqual,s=n.areFunctionsEqual,o=n.areMapsEqual,a=n.areNumbersEqual,c=n.areObjectsEqual,i=n.arePrimitiveWrappersEqual,u=n.areRegExpsEqual,f=n.areSetsEqual,l=n.areTypedArraysEqual,m=n.areUrlsEqual,p=n.unknownTagComparators;return function(h,d,E){if(h===d)return!0;if(h==null||d==null)return!1;var M=typeof h;if(M!==typeof d)return!1;if(M!=="object")return M==="number"?a(h,d,E):M==="function"?s(h,d,E):!1;var R=h.constructor;if(R!==d.constructor)return!1;if(R===Object)return c(h,d,E);if(xr(h))return e(h,d,E);if(Je!=null&&Je(h))return l(h,d,E);if(R===Date)return t(h,d,E);if(R===RegExp)return u(h,d,E);if(R===Map)return o(h,d,E);if(R===Set)return f(h,d,E);var P=Mr(h);if(P===dr)return t(h,d,E);if(P===wr)return u(h,d,E);if(P===hr)return o(h,d,E);if(P===yr)return f(h,d,E);if(P===gr)return typeof h.then!="function"&&typeof d.then!="function"&&c(h,d,E);if(P===vr)return m(h,d,E);if(P===mr)return r(h,d,E);if(P===ur)return c(h,d,E);if(P===fr||P===pr||P===Er)return i(h,d,E);if(p){var F=p[P];if(!F){var x=Kt(h);x&&(F=p[x])}if(F)return F(h,d,E)}return!1}}function Rr(n){var e=n.circular,t=n.createCustomConfig,r=n.strict,s={areArraysEqual:r?re:er,areDatesEqual:tr,areErrorsEqual:rr,areFunctionsEqual:nr,areMapsEqual:r?Ge(Xe,re):Xe,areNumbersEqual:sr,areObjectsEqual:r?re:or,arePrimitiveWrappersEqual:ir,areRegExpsEqual:ar,areSetsEqual:r?Ge(Ye,re):Ye,areTypedArraysEqual:r?re:cr,areUrlsEqual:lr,unknownTagComparators:void 0};if(t&&(s=Qe({},s,t(s))),e){var o=fe(s.areArraysEqual),a=fe(s.areMapsEqual),c=fe(s.areObjectsEqual),i=fe(s.areSetsEqual);s=Qe({},s,{areArraysEqual:o,areMapsEqual:a,areObjectsEqual:c,areSetsEqual:i})}return s}function br(n){return function(e,t,r,s,o,a,c){return n(e,t,c)}}function Ar(n){var e=n.circular,t=n.comparator,r=n.createState,s=n.equals,o=n.strict;if(r)return function(i,u){var f=r(),l=f.cache,m=l===void 0?e?new WeakMap:void 0:l,p=f.meta;return t(i,u,{cache:m,equals:s,meta:p,strict:o})};if(e)return function(i,u){return t(i,u,{cache:new WeakMap,equals:s,meta:void 0,strict:o})};var a={cache:void 0,equals:s,meta:void 0,strict:o};return function(i,u){return t(i,u,a)}}var et=V();V({strict:!0});V({circular:!0});V({circular:!0,strict:!0});V({createInternalComparator:function(){return J}});V({strict:!0,createInternalComparator:function(){return J}});V({circular:!0,createInternalComparator:function(){return J}});V({circular:!0,createInternalComparator:function(){return J},strict:!0});function V(n){n===void 0&&(n={});var e=n.circular,t=e===void 0?!1:e,r=n.createInternalComparator,s=n.createState,o=n.strict,a=o===void 0?!1:o,c=Rr(n),i=Cr(c),u=r?r(i):br(i);return Ar({circular:t,comparator:i,createState:s,equals:u,strict:a})}const tt=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],Ce=1,ne=8;class Ie{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[t,r]=new Uint8Array(e,0,2);if(t!==219)throw new Error("Data does not appear to be in a KDBush format.");const s=r>>4;if(s!==Ce)throw new Error(`Got v${s} data when expected v${Ce}.`);const o=tt[r&15];if(!o)throw new Error("Unrecognized array type.");const[a]=new Uint16Array(e,2,1),[c]=new Uint32Array(e,4,1);return new Ie(c,a,o,e)}constructor(e,t=64,r=Float64Array,s){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+t,2),65535),this.ArrayType=r,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const o=tt.indexOf(this.ArrayType),a=e*2*this.ArrayType.BYTES_PER_ELEMENT,c=e*this.IndexArrayType.BYTES_PER_ELEMENT,i=(8-c%8)%8;if(o<0)throw new Error(`Unexpected typed array class: ${r}.`);s&&s instanceof ArrayBuffer?(this.data=s,this.ids=new this.IndexArrayType(this.data,ne,e),this.coords=new this.ArrayType(this.data,ne+c+i,e*2),this._pos=e*2,this._finished=!0):(this.data=new ArrayBuffer(ne+a+c+i),this.ids=new this.IndexArrayType(this.data,ne,e),this.coords=new this.ArrayType(this.data,ne+c+i,e*2),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,(Ce<<4)+o]),new Uint16Array(this.data,2,1)[0]=t,new Uint32Array(this.data,4,1)[0]=e)}add(e,t){const r=this._pos>>1;return this.ids[r]=r,this.coords[this._pos++]=e,this.coords[this._pos++]=t,r}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return _e(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,t,r,s){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:o,coords:a,nodeSize:c}=this,i=[0,o.length-1,0],u=[];for(;i.length;){const f=i.pop()||0,l=i.pop()||0,m=i.pop()||0;if(l-m<=c){for(let d=m;d<=l;d++){const E=a[2*d],M=a[2*d+1];E>=e&&E<=r&&M>=t&&M<=s&&u.push(o[d])}continue}const p=m+l>>1,_=a[2*p],h=a[2*p+1];_>=e&&_<=r&&h>=t&&h<=s&&u.push(o[p]),(f===0?e<=_:t<=h)&&(i.push(m),i.push(p-1),i.push(1-f)),(f===0?r>=_:s>=h)&&(i.push(p+1),i.push(l),i.push(1-f))}return u}within(e,t,r){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:s,coords:o,nodeSize:a}=this,c=[0,s.length-1,0],i=[],u=r*r;for(;c.length;){const f=c.pop()||0,l=c.pop()||0,m=c.pop()||0;if(l-m<=a){for(let d=m;d<=l;d++)rt(o[2*d],o[2*d+1],e,t)<=u&&i.push(s[d]);continue}const p=m+l>>1,_=o[2*p],h=o[2*p+1];rt(_,h,e,t)<=u&&i.push(s[p]),(f===0?e-r<=_:t-r<=h)&&(c.push(m),c.push(p-1),c.push(1-f)),(f===0?e+r>=_:t+r>=h)&&(c.push(p+1),c.push(l),c.push(1-f))}return i}}function _e(n,e,t,r,s,o){if(s-r<=t)return;const a=r+s>>1;at(n,e,a,r,s,o),_e(n,e,t,r,a-1,1-o),_e(n,e,t,a+1,s,1-o)}function at(n,e,t,r,s,o){for(;s>r;){if(s-r>600){const u=s-r+1,f=t-r+1,l=Math.log(u),m=.5*Math.exp(2*l/3),p=.5*Math.sqrt(l*m*(u-m)/u)*(f-u/2<0?-1:1),_=Math.max(r,Math.floor(t-f*m/u+p)),h=Math.min(s,Math.floor(t+(u-f)*m/u+p));at(n,e,t,_,h,o)}const a=e[2*t+o];let c=r,i=s;for(se(n,e,r,t),e[2*s+o]>a&&se(n,e,r,s);c<i;){for(se(n,e,c,i),c++,i--;e[2*c+o]<a;)c++;for(;e[2*i+o]>a;)i--}e[2*r+o]===a?se(n,e,r,i):(i++,se(n,e,i,s)),i<=t&&(r=i+1),t<=i&&(s=i-1)}}function se(n,e,t,r){Re(n,t,r),Re(e,2*t,2*r),Re(e,2*t+1,2*r+1)}function Re(n,e,t){const r=n[e];n[e]=n[t],n[t]=r}function rt(n,e,t,r){const s=n-t,o=e-r;return s*s+o*o}const _r={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:n=>n},nt=Math.fround||(n=>e=>(n[0]=+e,n[0]))(new Float32Array(1)),X=2,G=3,be=4,Z=5,ct=6;class Nr{constructor(e){this.options=Object.assign(Object.create(_r),e),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(e){const{log:t,minZoom:r,maxZoom:s}=this.options;t&&console.time("total time");const o=`prepare ${e.length} points`;t&&console.time(o),this.points=e;const a=[];for(let i=0;i<e.length;i++){const u=e[i];if(!u.geometry)continue;const[f,l]=u.geometry.coordinates,m=nt(de(f)),p=nt(me(l));a.push(m,p,1/0,i,-1,1),this.options.reduce&&a.push(0)}let c=this.trees[s+1]=this._createTree(a);t&&console.timeEnd(o);for(let i=s;i>=r;i--){const u=+Date.now();c=this.trees[i]=this._createTree(this._cluster(c,i)),t&&console.log("z%d: %d clusters in %dms",i,c.numItems,+Date.now()-u)}return t&&console.timeEnd("total time"),this}getClusters(e,t){let r=((e[0]+180)%360+360)%360-180;const s=Math.max(-90,Math.min(90,e[1]));let o=e[2]===180?180:((e[2]+180)%360+360)%360-180;const a=Math.max(-90,Math.min(90,e[3]));if(e[2]-e[0]>=360)r=-180,o=180;else if(r>o){const l=this.getClusters([r,s,180,a],t),m=this.getClusters([-180,s,o,a],t);return l.concat(m)}const c=this.trees[this._limitZoom(t)],i=c.range(de(r),me(a),de(o),me(s)),u=c.data,f=[];for(const l of i){const m=this.stride*l;f.push(u[m+Z]>1?st(u,m,this.clusterProps):this.points[u[m+G]])}return f}getChildren(e){const t=this._getOriginId(e),r=this._getOriginZoom(e),s="No cluster with the specified id.",o=this.trees[r];if(!o)throw new Error(s);const a=o.data;if(t*this.stride>=a.length)throw new Error(s);const c=this.options.radius/(this.options.extent*Math.pow(2,r-1)),i=a[t*this.stride],u=a[t*this.stride+1],f=o.within(i,u,c),l=[];for(const m of f){const p=m*this.stride;a[p+be]===e&&l.push(a[p+Z]>1?st(a,p,this.clusterProps):this.points[a[p+G]])}if(l.length===0)throw new Error(s);return l}getLeaves(e,t,r){t=t||10,r=r||0;const s=[];return this._appendLeaves(s,e,t,r,0),s}getTile(e,t,r){const s=this.trees[this._limitZoom(e)],o=Math.pow(2,e),{extent:a,radius:c}=this.options,i=c/a,u=(r-i)/o,f=(r+1+i)/o,l={features:[]};return this._addTileFeatures(s.range((t-i)/o,u,(t+1+i)/o,f),s.data,t,r,o,l),t===0&&this._addTileFeatures(s.range(1-i/o,u,1,f),s.data,o,r,o,l),t===o-1&&this._addTileFeatures(s.range(0,u,i/o,f),s.data,-1,r,o,l),l.features.length?l:null}getClusterExpansionZoom(e){let t=this._getOriginZoom(e)-1;for(;t<=this.options.maxZoom;){const r=this.getChildren(e);if(t++,r.length!==1)break;e=r[0].properties.cluster_id}return t}_appendLeaves(e,t,r,s,o){const a=this.getChildren(t);for(const c of a){const i=c.properties;if(i&&i.cluster?o+i.point_count<=s?o+=i.point_count:o=this._appendLeaves(e,i.cluster_id,r,s,o):o<s?o++:e.push(c),e.length===r)break}return o}_createTree(e){const t=new Ie(e.length/this.stride|0,this.options.nodeSize,Float32Array);for(let r=0;r<e.length;r+=this.stride)t.add(e[r],e[r+1]);return t.finish(),t.data=e,t}_addTileFeatures(e,t,r,s,o,a){for(const c of e){const i=c*this.stride,u=t[i+Z]>1;let f,l,m;if(u)f=lt(t,i,this.clusterProps),l=t[i],m=t[i+1];else{const h=this.points[t[i+G]];f=h.properties;const[d,E]=h.geometry.coordinates;l=de(d),m=me(E)}const p={type:1,geometry:[[Math.round(this.options.extent*(l*o-r)),Math.round(this.options.extent*(m*o-s))]],tags:f};let _;u||this.options.generateId?_=t[i+G]:_=this.points[t[i+G]].id,_!==void 0&&(p.id=_),a.features.push(p)}}_limitZoom(e){return Math.max(this.options.minZoom,Math.min(Math.floor(+e),this.options.maxZoom+1))}_cluster(e,t){const{radius:r,extent:s,reduce:o,minPoints:a}=this.options,c=r/(s*Math.pow(2,t)),i=e.data,u=[],f=this.stride;for(let l=0;l<i.length;l+=f){if(i[l+X]<=t)continue;i[l+X]=t;const m=i[l],p=i[l+1],_=e.within(i[l],i[l+1],c),h=i[l+Z];let d=h;for(const E of _){const M=E*f;i[M+X]>t&&(d+=i[M+Z])}if(d>h&&d>=a){let E=m*h,M=p*h,R,P=-1;const F=((l/f|0)<<5)+(t+1)+this.points.length;for(const x of _){const U=x*f;if(i[U+X]<=t)continue;i[U+X]=t;const $=i[U+Z];E+=i[U]*$,M+=i[U+1]*$,i[U+be]=F,o&&(R||(R=this._map(i,l,!0),P=this.clusterProps.length,this.clusterProps.push(R)),o(R,this._map(i,U)))}i[l+be]=F,u.push(E/d,M/d,1/0,F,-1,d),o&&u.push(P)}else{for(let E=0;E<f;E++)u.push(i[l+E]);if(d>1)for(const E of _){const M=E*f;if(!(i[M+X]<=t)){i[M+X]=t;for(let R=0;R<f;R++)u.push(i[M+R])}}}}return u}_getOriginId(e){return e-this.points.length>>5}_getOriginZoom(e){return(e-this.points.length)%32}_map(e,t,r){if(e[t+Z]>1){const a=this.clusterProps[e[t+ct]];return r?Object.assign({},a):a}const s=this.points[e[t+G]].properties,o=this.options.map(s);return r&&o===s?Object.assign({},o):o}}function st(n,e,t){return{type:"Feature",id:n[e+G],properties:lt(n,e,t),geometry:{type:"Point",coordinates:[kr(n[e]),Ir(n[e+1])]}}}function lt(n,e,t){const r=n[e+Z],s=r>=1e4?`${Math.round(r/1e3)}k`:r>=1e3?`${Math.round(r/100)/10}k`:r,o=n[e+ct],a=o===-1?{}:Object.assign({},t[o]);return Object.assign(a,{cluster:!0,cluster_id:n[e+G],point_count:r,point_count_abbreviated:s})}function de(n){return n/360+.5}function me(n){const e=Math.sin(n*Math.PI/180),t=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return t<0?0:t>1?1:t}function kr(n){return(n-.5)*360}function Ir(n){const e=(180-n*360)*Math.PI/180;return 360*Math.atan(Math.exp(e))/Math.PI-90}function Pr(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t}class j{static isAdvancedMarkerAvailable(e){return google.maps.marker&&e.getMapCapabilities().isAdvancedMarkersAvailable===!0}static isAdvancedMarker(e){return google.maps.marker&&e instanceof google.maps.marker.AdvancedMarkerElement}static setMap(e,t){this.isAdvancedMarker(e)?e.map=t:e.setMap(t)}static getPosition(e){if(this.isAdvancedMarker(e)){if(e.position){if(e.position instanceof google.maps.LatLng)return e.position;if(Number.isFinite(e.position.lat)&&Number.isFinite(e.position.lng))return new google.maps.LatLng(e.position.lat,e.position.lng)}return new google.maps.LatLng(null)}return e.getPosition()}static getVisible(e){return this.isAdvancedMarker(e)?!0:e.getVisible()}}class Ne{constructor({markers:e,position:t}){this.markers=[],e&&(this.markers=e),t&&(t instanceof google.maps.LatLng?this._position=t:this._position=new google.maps.LatLng(t))}get bounds(){if(this.markers.length===0&&!this._position)return;const e=new google.maps.LatLngBounds(this._position,this._position);for(const t of this.markers)e.extend(j.getPosition(t));return e}get position(){return this._position||this.bounds.getCenter()}get count(){return this.markers.filter(e=>j.getVisible(e)).length}push(e){this.markers.push(e)}delete(){this.marker&&(j.setMap(this.marker,null),this.marker=void 0),this.markers.length=0}}function ke(n,e="assertion failed"){if(n==null)throw Error(e)}class Or{constructor({maxZoom:e=16}){this.maxZoom=e}noop({markers:e}){return Sr(e)}}const Sr=n=>n.map(t=>new Ne({position:j.getPosition(t),markers:[t]}));class ut extends Or{constructor(e){var{maxZoom:t,radius:r=60}=e,s=Pr(e,["maxZoom","radius"]);super({maxZoom:t}),this.markers=[],this.clusters=[],this.state={zoom:-1},this.superCluster=new Nr(Object.assign({maxZoom:this.maxZoom,radius:r},s))}calculate(e){let t=!1,r=e.map.getZoom();ke(r),r=Math.round(r);const s={zoom:r};if(!et(e.markers,this.markers)){t=!0,this.markers=[...e.markers];const o=this.markers.map(a=>{const c=j.getPosition(a);return{type:"Feature",geometry:{type:"Point",coordinates:[c.lng(),c.lat()]},properties:{marker:a}}});this.superCluster.load(o)}return t||(this.state.zoom<=this.maxZoom||s.zoom<=this.maxZoom)&&(t=!et(this.state,s)),this.state=s,e.markers.length===0?(this.clusters=[],{clusters:this.clusters,changed:t}):(t&&(this.clusters=this.cluster(e)),{clusters:this.clusters,changed:t})}cluster({map:e}){const t=e.getZoom();return ke(t),this.superCluster.getClusters([-180,-90,180,90],Math.round(t)).map(r=>this.transformCluster(r))}transformCluster({geometry:{coordinates:[e,t]},properties:r}){if(r.cluster)return new Ne({markers:this.superCluster.getLeaves(r.cluster_id,1/0).map(o=>o.properties.marker),position:{lat:t,lng:e}});const s=r.marker;return new Ne({markers:[s],position:j.getPosition(s)})}}class Lr{constructor(e,t){this.markers={sum:e.length};const r=t.map(o=>o.count),s=r.reduce((o,a)=>o+a,0);this.clusters={count:t.length,markers:{mean:s/t.length,sum:s,min:Math.min(...r),max:Math.max(...r)}}}}class Tr{render({count:e,position:t},r,s){const a=`<svg fill="${e>Math.max(10,r.clusters.markers.mean)?"#ff0000":"#0000ff"}" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 240 240" width="50" height="50">
<circle cx="120" cy="120" opacity=".6" r="70" />
<circle cx="120" cy="120" opacity=".3" r="90" />
<circle cx="120" cy="120" opacity=".2" r="110" />
<text x="50%" y="50%" style="fill:#fff" text-anchor="middle" font-size="50" dominant-baseline="middle" font-family="roboto,arial,sans-serif">${e}</text>
</svg>`,c=`Cluster of ${e} markers`,i=Number(google.maps.Marker.MAX_ZINDEX)+e;if(j.isAdvancedMarkerAvailable(s)){const l=new DOMParser().parseFromString(a,"image/svg+xml").documentElement;l.setAttribute("transform","translate(0 25)");const m={map:s,position:t,zIndex:i,title:c,content:l};return new google.maps.marker.AdvancedMarkerElement(m)}const u={position:t,zIndex:i,title:c,icon:{url:`data:image/svg+xml;base64,${btoa(a)}`,anchor:new google.maps.Point(25,25)}};return new google.maps.Marker(u)}}function Dr(n,e){for(let t in e.prototype)n.prototype[t]=e.prototype[t]}class Pe{constructor(){Dr(Pe,google.maps.OverlayView)}}var Y;(function(n){n.CLUSTERING_BEGIN="clusteringbegin",n.CLUSTERING_END="clusteringend",n.CLUSTER_CLICK="click",n.GMP_CLICK="gmp-click"})(Y||(Y={}));const jr=(n,e,t)=>{e.bounds&&t.fitBounds(e.bounds)};class Fr extends Pe{constructor({map:e,markers:t=[],algorithmOptions:r={},algorithm:s=new ut(r),renderer:o=new Tr,onClusterClick:a=jr}){super(),this.map=null,this.idleListener=null,this.markers=[...t],this.clusters=[],this.algorithm=s,this.renderer=o,this.onClusterClick=a,e&&this.setMap(e)}addMarker(e,t){this.markers.includes(e)||(this.markers.push(e),t||this.render())}addMarkers(e,t){e.forEach(r=>{this.addMarker(r,!0)}),t||this.render()}removeMarker(e,t){const r=this.markers.indexOf(e);return r===-1?!1:(j.setMap(e,null),this.markers.splice(r,1),t||this.render(),!0)}removeMarkers(e,t){let r=!1;return e.forEach(s=>{r=this.removeMarker(s,!0)||r}),r&&!t&&this.render(),r}clearMarkers(e){this.markers.length=0,e||this.render()}render(){const e=this.getMap();if(e instanceof google.maps.Map&&e.getProjection()){google.maps.event.trigger(this,Y.CLUSTERING_BEGIN,this);const{clusters:t,changed:r}=this.algorithm.calculate({markers:this.markers,map:e,mapCanvasProjection:this.getProjection()});if(r||r==null){const s=new Set;for(const a of t)a.markers.length==1&&s.add(a.markers[0]);const o=[];for(const a of this.clusters)a.marker!=null&&(a.markers.length==1?s.has(a.marker)||j.setMap(a.marker,null):o.push(a.marker));this.clusters=t,this.renderClusters(),requestAnimationFrame(()=>o.forEach(a=>j.setMap(a,null)))}google.maps.event.trigger(this,Y.CLUSTERING_END,this)}}onAdd(){const e=this.getMap();ke(e),this.idleListener=e.addListener("idle",this.render.bind(this)),this.render()}onRemove(){this.idleListener&&google.maps.event.removeListener(this.idleListener),this.reset()}reset(){this.markers.forEach(e=>j.setMap(e,null)),this.clusters.forEach(e=>e.delete()),this.clusters=[]}renderClusters(){const e=new Lr(this.markers,this.clusters),t=this.getMap();this.clusters.forEach(r=>{if(r.markers.length===1)r.marker=r.markers[0];else if(r.marker=this.renderer.render(r,e,t),r.markers.forEach(s=>j.setMap(s,null)),this.onClusterClick){const s=j.isAdvancedMarker(r.marker)?Y.GMP_CLICK:Y.CLUSTER_CLICK;r.marker.addListener(s,o=>{google.maps.event.trigger(this,Y.CLUSTER_CLICK,r),this.onClusterClick(o,r,t)})}j.setMap(r.marker,t)})}}async function qr(n=ot){return new Promise(e=>{const t=Date.now(),r=()=>{const s=document.getElementById("shop-details"),o=document.getElementById("shop-socials"),a=(s==null?void 0:s.getBoundingClientRect().width)||0,c=(o==null?void 0:o.getBoundingClientRect().width)||0;if(a>Ue||c>Ue){e(!0);return}if(Date.now()-t>=n){e(!1);return}requestAnimationFrame(r)};requestAnimationFrame(r)})}function Ae(n){var t;if(!((t=n==null?void 0:n.geometry)!=null&&t.location))return null;const e=n.geometry.location;return typeof e.lat=="function"?e:typeof e.lat=="number"?new window.google.maps.LatLng(e.lat,e.lng):null}function Wr(n,e){if(window.innerWidth<ht)return{x:0,y:0};const t=window.innerWidth,r=window.innerHeight;let s=0,o=0,a=0;const c=document.querySelector("header");if(c&&(a=c.getBoundingClientRect().height),n){const d=document.getElementById("shop-details");d&&(s=d.getBoundingClientRect().width)}else{const d=document.getElementById("card-listings");d&&(s=d.getBoundingClientRect().width)}if(e){const d=document.getElementById("shop-socials");d&&(o=d.getBoundingClientRect().width)}const i=t-s-o,u=o+i/2,f=t/2,l=u-f,m=r-a,p=a+m/2,_=r/2,h=p-_;return{x:l,y:h}}function Ur(n){const e=n.getDiv();return Math.min(e.offsetWidth,e.offsetHeight)*pt}function Br(n){return{x:0,y:n.getDiv().offsetHeight*.15}}function $r(n,e,t,r){const s=Math.pow(2,n.getZoom()),o=n.getProjection();if(!o)return e;const a=o.fromLatLngToPoint(e);if(!a)return e;const c=new google.maps.Point(a.x-t/s,a.y-r/s);return o.fromPointToLatLng(c)||e}function Q(n){const{map:e,targetLatLng:t,isShopDetailsOpen:r,isShopSocialsOpen:s,includeInfoWindowOffset:o=!1,bounds:a}=n,{x:c,y:i}=Wr(r,s);if(a){const u=Ur(e);if(c!==0||i!==0){const f=Math.abs(c)*2,l=Math.abs(i)*2,m={top:u+l,right:u+f,bottom:u,left:u};e.fitBounds(a,m)}else e.fitBounds(a,u)}else{let u=c,f=i;if(o){const m=Br(e);u+=m.x,f+=m.y}const l=$r(e,t,u,f);e.panTo(l)}}const zr=({rating:n,reviewCount:e})=>{const t=Math.floor(n),r=n%1>=.5,s=5-t-(r?1:0),o=e!==void 0?`Rating: ${n.toFixed(1)} out of 5 stars from ${e} reviews`:`Rating: ${n.toFixed(1)} out of 5 stars`;return I.jsxDEV("div",{id:"info-window-rating",className:"flex items-center gap-x-0.5 text-xs",role:"img","aria-label":o,children:[I.jsxDEV("span",{id:"info-window-rating-value",className:"font-semibold text-gray-700 mr-1","aria-hidden":"true",children:n.toFixed(1)},void 0,!1,{fileName:"/Users/chris.majorossy/Projects/FarrmFinder/phreshfoods.com/src/components/Map/InfoWindowContent.tsx",lineNumber:18,columnNumber:7},void 0),Array(t).fill(0).map((a,c)=>I.jsxDEV("svg",{className:"w-3 h-3 fill-current text-yellow-400",viewBox:"0 0 20 20","aria-hidden":"true",children:I.jsxDEV("path",{d:"M10 15l-5.878 3.09 1.123-6.545L.489 6.91l6.572-.955L10 0l2.939 5.955 6.572.955-4.756 4.635 1.123 6.545z"},void 0,!1,{fileName:"/Users/chris.majorossy/Projects/FarrmFinder/phreshfoods.com/src/components/Map/InfoWindowContent.tsx",lineNumber:20,columnNumber:120},void 0)},`full-${c}`,!1,{fileName:"/Users/chris.majorossy/Projects/FarrmFinder/phreshfoods.com/src/components/Map/InfoWindowContent.tsx",lineNumber:20,columnNumber:9},void 0)),r&&I.jsxDEV("svg",{className:"w-3 h-3 fill-current text-yellow-400",viewBox:"0 0 20 20","aria-hidden":"true",children:[I.jsxDEV("path",{d:"M10 15l-5.878 3.09 1.123-6.545L.489 6.91l6.572-.955L10 0l2.939 5.955 6.572.955-4.756 4.635 1.123 6.545z",clipPath:"inset(0 50% 0 0)"},void 0,!1,{fileName:"/Users/chris.majorossy/Projects/FarrmFinder/phreshfoods.com/src/components/Map/InfoWindowContent.tsx",lineNumber:24,columnNumber:11},void 0),I.jsxDEV("path",{d:"M10 15l-5.878 3.09 1.123-6.545L.489 6.91l6.572-.955L10 0l2.939 5.955 6.572.955-4.756 4.635 1.123 6.545z",fill:"lightgray",clipPath:"inset(0 0 0 50%)"},void 0,!1,{fileName:"/Users/chris.majorossy/Projects/FarrmFinder/phreshfoods.com/src/components/Map/InfoWindowContent.tsx",lineNumber:25,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/chris.majorossy/Projects/FarrmFinder/phreshfoods.com/src/components/Map/InfoWindowContent.tsx",lineNumber:23,columnNumber:9},void 0),Array(s).fill(0).map((a,c)=>I.jsxDEV("svg",{className:"w-3 h-3 fill-current text-gray-300",viewBox:"0 0 20 20","aria-hidden":"true",children:I.jsxDEV("path",{d:"M10 15l-5.878 3.09 1.123-6.545L.489 6.91l6.572-.955L10 0l2.939 5.955 6.572.955-4.756 4.635 1.123 6.545z"},void 0,!1,{fileName:"/Users/chris.majorossy/Projects/FarrmFinder/phreshfoods.com/src/components/Map/InfoWindowContent.tsx",lineNumber:29,columnNumber:119},void 0)},`empty-${c}`,!1,{fileName:"/Users/chris.majorossy/Projects/FarrmFinder/phreshfoods.com/src/components/Map/InfoWindowContent.tsx",lineNumber:29,columnNumber:9},void 0)),e!==void 0&&I.jsxDEV("span",{id:"info-window-review-count",className:"ml-1 text-gray-500","aria-hidden":"true",children:["(",e,")"]},void 0,!0,{fileName:"/Users/chris.majorossy/Projects/FarrmFinder/phreshfoods.com/src/components/Map/InfoWindowContent.tsx",lineNumber:31,columnNumber:37},void 0)]},void 0,!0,{fileName:"/Users/chris.majorossy/Projects/FarrmFinder/phreshfoods.com/src/components/Map/InfoWindowContent.tsx",lineNumber:17,columnNumber:5},void 0)},Zr=({shop:n})=>{var e;return n?I.jsxDEV("div",{id:"info-window-content",className:"infowindow-content-wrapper font-sans text-sm",style:{width:"250px"},children:[" ",I.jsxDEV(gt,{shop:n,displayMode:"compact",showCategories:!0,showProductNames:!1,iconSize:"sm"},void 0,!1,{fileName:"/Users/chris.majorossy/Projects/FarrmFinder/phreshfoods.com/src/components/Map/InfoWindowContent.tsx",lineNumber:49,columnNumber:7},void 0),I.jsxDEV("div",{id:"info-window-details",className:"p-2",children:[I.jsxDEV("h3",{id:"info-window-name",className:"text-sm font-semibold mb-0.5 truncate text-gray-800 leading-tight",title:n.Name,children:n.Name},void 0,!1,{fileName:"/Users/chris.majorossy/Projects/FarrmFinder/phreshfoods.com/src/components/Map/InfoWindowContent.tsx",lineNumber:58,columnNumber:9},void 0),((e=n.placeDetails)==null?void 0:e.rating)!==void 0&&n.placeDetails.rating>0&&I.jsxDEV("div",{id:"info-window-rating-wrapper",className:"mb-1",children:I.jsxDEV(zr,{rating:n.placeDetails.rating,reviewCount:n.placeDetails.user_ratings_total},void 0,!1,{fileName:"/Users/chris.majorossy/Projects/FarrmFinder/phreshfoods.com/src/components/Map/InfoWindowContent.tsx",lineNumber:65,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/chris.majorossy/Projects/FarrmFinder/phreshfoods.com/src/components/Map/InfoWindowContent.tsx",lineNumber:64,columnNumber:11},void 0),n.Address&&I.jsxDEV("p",{id:"info-window-address",className:"text-xs text-gray-600 mb-1.5 leading-snug line-clamp-2",title:n.Address,children:n.Address},void 0,!1,{fileName:"/Users/chris.majorossy/Projects/FarrmFinder/phreshfoods.com/src/components/Map/InfoWindowContent.tsx",lineNumber:70,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/chris.majorossy/Projects/FarrmFinder/phreshfoods.com/src/components/Map/InfoWindowContent.tsx",lineNumber:57,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/chris.majorossy/Projects/FarrmFinder/phreshfoods.com/src/components/Map/InfoWindowContent.tsx",lineNumber:47,columnNumber:5},void 0):null},Gr=zt.memo(Zr,(n,e)=>{const t=n.shop,r=e.shop;return!t&&!r?!0:!t||!r?!1:t.slug===r.slug&&t.GoogleProfileID===r.GoogleProfileID&&t.Name===r.Name}),Xr=()=>{var We;const n=A.useRef(null),e=A.useRef(null),t=A.useRef(new Map),r=A.useRef(null),s=A.useRef(null),o=A.useRef(null),a=A.useRef(null),c=A.useRef(null),i=A.useRef(null),u=A.useRef(null),f=A.useRef(null),l=A.useRef(null),m=A.useRef(null),p=A.useRef(null),_=A.useRef(!1),h=A.useRef(!1),d=Zt(),{currentlyDisplayedLocations:E}=wt(),{mapsApiReady:M,mapViewTargetLocation:R,currentRadius:P,lastPlaceSelectedByAutocomplete:F}=yt(),{selectedShop:x,setSelectedShop:U,hoveredShop:$,setHoveredShop:oe,openShopOverlays:Oe,isShopDetailsOpen:q,isShopSocialsOpen:W,previewShop:L,setPreviewShop:Se}=Et(),{directionsResult:ie,clearDirections:Le}=vt(),{activeProductFilters:Te,activeLocationTypes:De}=xt(),{tripDirectionsResult:je}=Mt(),B=A.useCallback(()=>{var g;(g=r.current)!=null&&g.getMap()&&r.current.close()},[]),ae=A.useCallback(()=>{p.current&&clearTimeout(p.current),p.current=setTimeout(()=>{!_.current&&!h.current&&oe(null)},Be)},[oe]),H=A.useCallback(()=>{o.current&&(clearTimeout(o.current),o.current=null);const g=s.current;g&&(s.current=null,o.current=setTimeout(()=>{try{g.unmount()}catch(y){console.warn("[MapComponent] Error unmounting InfoWindow React root:",y)}o.current=null},0))},[]),Fe=A.useCallback((g=Ct)=>{const y=window.innerWidth<768,v=document.createElement("div");v.style.width=y?"44px":`${le+8}px`,v.style.height=y?"44px":`${le+8}px`,v.style.display="flex",v.style.alignItems="center",v.style.justifyContent="center",v.style.cursor="pointer";const C=document.createElement("div");return C.style.width=`${le}px`,C.style.height=`${le}px`,C.style.borderRadius="50%",C.style.border=`${Me}px solid white`,C.style.boxShadow="0 2px 5px rgba(0,0,0,0.5)",C.style.transition=`transform ${ue} cubic-bezier(0.4, 0, 0.2, 1), background-color ${ue} cubic-bezier(0.4, 0, 0.2, 1), background-image ${ue} cubic-bezier(0.4, 0, 0.2, 1), border-width ${ue} cubic-bezier(0.4, 0, 0.2, 1)`,C.style.backgroundColor=g,C.style.pointerEvents="none",C.style.willChange="transform",v.appendChild(C),v},[]),qe=A.useCallback(g=>y=>{var C;(C=y.domEvent)==null||C.stopPropagation();const v=E.find(b=>b.slug===g.slug||b.GoogleProfileID===g.GoogleProfileID)||g;if(Se(null),U(v),Oe(v,"shop"),g.slug){const b=Rt(g.type),k=bt({locationTypes:De,productFilters:Te,searchLocation:F,searchRadius:P}).toString(),D=k?`${b}/${g.slug}?${k}`:`${b}/${g.slug}`;d(D,{replace:!0})}B(),H()},[E,U,Se,Oe,d,B,H,De,Te,F,P]);return A.useEffect(()=>{var v,C;if(!M||!n.current||e.current)return;const g=new window.google.maps.Map(n.current,{center:Nt,zoom:_t,mapTypeControl:!1,gestureHandling:"greedy",zoomControl:!1,streetViewControl:!1,fullscreenControl:!1,rotateControl:!1,cameraControl:!1,mapId:At,styles:void 0});e.current=g,m.current=new Fr({map:g,markers:[],algorithm:new ut({radius:60,minPoints:3}),renderer:{render:({count:b,position:O})=>{const S=window.btoa(`
            <svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" viewBox="0 0 50 50">
              <circle cx="25" cy="25" r="20" fill="#1a6a41" stroke="#fff" stroke-width="3"/>
              <text x="25" y="30" font-size="14" font-weight="bold" text-anchor="middle" fill="white">${b}</text>
            </svg>
          `);return new window.google.maps.marker.AdvancedMarkerElement({position:O,content:(()=>{const k=document.createElement("div");return k.style.width="50px",k.style.height="50px",k.style.backgroundImage=`url('data:image/svg+xml;base64,${S}')`,k.style.backgroundSize="contain",k.style.cursor="pointer",k.style.transform="translate(-50%, -50%)",k})(),zIndex:1e3})}}}),r.current=new window.google.maps.InfoWindow({pixelOffset:new window.google.maps.Size(kt,It),disableAutoPan:!1}),(C=(v=window.google)==null?void 0:v.maps)!=null&&C.DirectionsRenderer&&(a.current=new window.google.maps.DirectionsRenderer({}),a.current.setMap(g));const y=g.addListener("click",b=>{b.placeId||(B(),H(),d("/",{replace:!0}),ie&&Le())});return()=>{if(y&&y.remove(),a.current&&(a.current.setMap(null),a.current=null),m.current&&(m.current.clearMarkers(),m.current.setMap(null),m.current=null),f.current&&(f.current.map=null,f.current=null),l.current&&(l.current.setMap(null),l.current=null),o.current&&(clearTimeout(o.current),o.current=null),p.current&&(clearTimeout(p.current),p.current=null),_.current=!1,h.current=!1,B(),s.current){try{s.current.unmount()}catch{}s.current=null}}},[M,d,B,H,ie,Le]),A.useEffect(()=>{var D,ee;const g=e.current;if(!g||!M||!((ee=(D=window.google)==null?void 0:D.maps)!=null&&ee.marker)||!E)return;const y=new Map,v=(x==null?void 0:x.slug)||null,C=v!==c.current,b=($==null?void 0:$.slug)||null,O=b!==i.current,S=(L==null?void 0:L.slug)||null,k=S!==u.current;if(E.forEach((w,z)=>{if(w.lat==null||w.lng==null||isNaN(w.lat)||isNaN(w.lng))return;const K=w.slug||w.GoogleProfileID||String(w.id)||`marker-${z}`;if(!K)return;const he=$e[w.type]||$e.default;let T=t.current.get(K);const pe=!!T;if(T){const N=T.position;(!N||(typeof N.lat=="function"?N.lat()!==w.lat:N.lat!==w.lat)||(typeof N.lng=="function"?N.lng()!==w.lng:N.lng!==w.lng))&&(T.position={lat:w.lat,lng:w.lng}),T.map||(T.map=g),T.title!==w.Name&&(T.title=w.Name)}else{const N=Fe(he);N.addEventListener("mouseenter",()=>{_.current=!0,p.current&&clearTimeout(p.current),p.current=setTimeout(()=>{oe(w)},Be)}),N.addEventListener("mouseleave",()=>{_.current=!1,ae()}),T=new window.google.maps.marker.AdvancedMarkerElement({position:{lat:w.lat,lng:w.lng},map:null,title:w.Name,content:N}),T.addListener("gmp-click",qe(w))}const ge=v===w.slug,ft=c.current===w.slug,te=b===w.slug,dt=i.current===w.slug,we=S===w.slug,mt=u.current===w.slug;let ye=Pt,Ee=he,ce="",ve=z+qt;if((te||ge||we)&&(ye=te?"scale(2.0)":"scale(2.08125)",ce="url(https://www.maine.gov/sos/kids/themes/kids/images/flag.gif)",Ee="",ve=te?Bt:$t),!pe||C&&(ge||ft)||O&&(te||dt)||k&&(we||mt)){const N=T.content.firstChild;if(N){N.style.transform!==ye&&(N.style.transform=ye),ce?N.style.backgroundImage!==ce&&(N.style.backgroundImage=ce,N.style.backgroundSize="148%",N.style.backgroundPosition="52% 66%",N.style.backgroundColor=""):N.style.backgroundColor!==Ee&&(N.style.backgroundImage="",N.style.backgroundColor=Ee,N.style.backgroundSize="",N.style.backgroundPosition="");const xe=te||ge||we?`${Me*.5}px`:`${Me}px`;N.style.borderWidth!==xe&&(N.style.borderWidth=xe)}T.zIndex!==ve&&(T.zIndex=ve)}y.set(K,T)}),c.current=v,i.current=b,u.current=S,t.current.size!==y.size&&t.current.forEach((w,z)=>{y.has(z)||(w.map=null)}),t.current=y,m.current){m.current.clearMarkers();const w=Array.from(y.values());m.current.addMarkers(w),m.current.render()}},[E,M,x,$,L,Fe,qe,ae,oe]),A.useEffect(()=>{var C,b;const g=e.current;if(!g||!M||!x||!((b=(C=window.google)==null?void 0:C.maps)!=null&&b.LatLng)||x.lat==null||x.lng==null||isNaN(x.lat)||isNaN(x.lng))return;const y=new window.google.maps.LatLng(x.lat,x.lng);(async()=>{(q||W)&&!await qr(ot)||Q({map:g,targetLatLng:y,isShopDetailsOpen:q,isShopSocialsOpen:W,includeInfoWindowOffset:!0})})()},[x,M,q,W]),A.useEffect(()=>{var C,b;const g=e.current;if(!g||!M||!L||!((b=(C=window.google)==null?void 0:C.maps)!=null&&b.LatLng)||L.lat==null||L.lng==null||isNaN(L.lat)||isNaN(L.lng)||x&&(L.slug===x.slug||L.GoogleProfileID===x.GoogleProfileID))return;const v=new window.google.maps.LatLng(L.lat,L.lng);g.panTo(v)},[L,x,M]),A.useEffect(()=>{var v;const g=e.current;if(!g||!M||!((v=R==null?void 0:R.geometry)!=null&&v.location))return;const y=Ae(R);y&&requestAnimationFrame(()=>{var S,k,D,ee;if(!f.current&&((k=(S=window.google)==null?void 0:S.maps)!=null&&k.marker)){const w=document.createElement("img"),z=window.devicePixelRatio||1;let K="@1x";z>2.5?K="@3x":z>1.5&&(K="@2x");const T=document.createElement("canvas").toDataURL("image/webp").indexOf("data:image/webp")===0?"webp":"png";w.src=`/images/center-pin${K}.${T}`,w.alt="Search location marker",w.style.width=`${ze}px`,w.style.height=`${ze}px`,w.style.cursor="pointer";const pe=new window.google.maps.marker.AdvancedMarkerElement({position:y,map:g,content:w,title:R.formatted_address||"Searched Location",zIndex:Ot});f.current=pe}else f.current&&(f.current.position=y);const C=P*Wt;if(!l.current&&((ee=(D=window.google)==null?void 0:D.maps)!=null&&ee.Circle)){const w=new window.google.maps.Circle({map:g,center:y,radius:C,fillColor:Ze,fillOpacity:Dt,strokeColor:Ze,strokeOpacity:Tt,strokeWeight:Lt,clickable:!1,zIndex:St});l.current=w}else if(l.current){const w=l.current.getCenter(),z=l.current.getRadius();(!w||w.lat()!==y.lat()||w.lng()!==y.lng())&&l.current.setCenter(y),z!==C&&l.current.setRadius(C)}const b=l.current,O=b==null?void 0:b.getBounds();Q({map:g,targetLatLng:y,isShopDetailsOpen:q,isShopSocialsOpen:W,includeInfoWindowOffset:!1,bounds:O||void 0})})},[R,P,M,q,W]),A.useEffect(()=>{const g=e.current;if(!g||!M)return;const y=document.getElementById("listingsPanel");if(!y)return;let v;const C=new ResizeObserver(b=>{clearTimeout(v),v=setTimeout(()=>{var O,S;if(x&&x.lat!=null&&x.lng!=null){const k=new window.google.maps.LatLng(x.lat,x.lng);Q({map:g,targetLatLng:k,isShopDetailsOpen:q,isShopSocialsOpen:W,includeInfoWindowOffset:!0})}else if((O=R==null?void 0:R.geometry)!=null&&O.location){const k=Ae(R);if(!k)return;const D=(S=l.current)==null?void 0:S.getBounds();Q({map:g,targetLatLng:k,isShopDetailsOpen:q,isShopSocialsOpen:W,includeInfoWindowOffset:!1,bounds:D||void 0})}},jt)});return C.observe(y),()=>{clearTimeout(v),C.disconnect()}},[M,x,R,q,W]),A.useEffect(()=>{const g=e.current;if(!g||!M)return;let y;const v=()=>{clearTimeout(y),y=setTimeout(()=>{var C,b;if(x&&x.lat!=null&&x.lng!=null){const O=new window.google.maps.LatLng(x.lat,x.lng);Q({map:g,targetLatLng:O,isShopDetailsOpen:q,isShopSocialsOpen:W,includeInfoWindowOffset:!0})}else if((C=R==null?void 0:R.geometry)!=null&&C.location){const O=Ae(R);if(!O)return;const S=(b=l.current)==null?void 0:b.getBounds();Q({map:g,targetLatLng:O,isShopDetailsOpen:q,isShopSocialsOpen:W,includeInfoWindowOffset:!1,bounds:S||void 0})}},Ut)};return window.addEventListener("resize",v),()=>{clearTimeout(y),window.removeEventListener("resize",v)}},[M,x,R,q,W]),A.useEffect(()=>{if(M&&a.current){const g=je||ie;g?a.current.setDirections(g):a.current.setDirections({routes:[]})}},[ie,je,M]),A.useEffect(()=>{const g=e.current,y=r.current;if(!M||!g||!y){y!=null&&y.getMap()&&B(),s.current&&H();return}const v=L||x||$;if(v&&v.lat!=null&&v.lng!=null){const C=v.slug||v.GoogleProfileID||String(v.id),b=t.current.get(C);if(b){if(s.current){const k=s.current;s.current=null,o.current&&(clearTimeout(o.current),o.current=null);try{k.unmount()}catch(D){console.warn("[MapComponent] Error unmounting previous InfoWindow React root:",D)}}const O=document.createElement("div"),S=Ft.createRoot(O);s.current=S,S.render(I.jsxDEV(Gr,{shop:v},void 0,!1,{fileName:"/Users/chris.majorossy/Projects/FarrmFinder/phreshfoods.com/src/components/Map/MapComponent.tsx",lineNumber:836,columnNumber:11},void 0)),y.setContent(O),(!y.getMap()||y.getAnchor()!==b)&&y.open({anchor:b,map:g}),setTimeout(()=>{const k=document.querySelectorAll(".gm-style-iw-c"),D=k[k.length-1];D&&(D.addEventListener("mouseenter",()=>{h.current=!0,p.current&&(clearTimeout(p.current),p.current=null)}),D.addEventListener("mouseleave",()=>{h.current=!1,ae()}))},0)}else B()}else B();return()=>{B(),H()}},[x,L,$,M,B,H,ae]),I.jsxDEV("div",{id:"map",ref:n,className:"w-full h-full bg-gray-200",role:"application","aria-label":"Interactive map showing farm stands, cheesemongers, fishmongers, butchers, and antique shops in Maine","aria-describedby":"map-description",children:[I.jsxDEV("div",{id:"map-description",className:"sr-only",children:"An interactive Google Map displaying locations of local businesses. Click on map markers to view details. Use shop cards in the left panel for keyboard navigation."},void 0,!1,{fileName:"/Users/chris.majorossy/Projects/FarrmFinder/phreshfoods.com/src/components/Map/MapComponent.tsx",lineNumber:890,columnNumber:7},void 0),I.jsxDEV("div",{"aria-live":"polite","aria-atomic":"true",className:"sr-only",children:x&&`Selected: ${((We=x.placeDetails)==null?void 0:We.name)||x.Name}`},void 0,!1,{fileName:"/Users/chris.majorossy/Projects/FarrmFinder/phreshfoods.com/src/components/Map/MapComponent.tsx",lineNumber:894,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/chris.majorossy/Projects/FarrmFinder/phreshfoods.com/src/components/Map/MapComponent.tsx",lineNumber:882,columnNumber:5},void 0)};export{Xr as default};
